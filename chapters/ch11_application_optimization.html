<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>11. An Application: Approximation and Optimization &#8212; Programming with Python for Engineers 1.0 documentation</title>

    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/d2l.css" />
    <link rel="stylesheet" href="../_static/material-design-lite-1.3.0/material.blue-deep_orange.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx_materialdesign_theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/fontawesome/all.css" type="text/css" />
    <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/d2l.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="12. An Application: Solving a Simple Regression Problem" href="ch12_regression.html" />
    <link rel="prev" title="10. Scientific and Engineering Libraries" href="ch10_scientific_libraries.html" /> 
  </head>
<body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-drawer"><header class="mdl-layout__header mdl-layout__header--waterfall ">
    <div class="mdl-layout__header-row">
        
        <nav class="mdl-navigation breadcrumb">
            <a class="mdl-navigation__link is-active"><span class="section-number">11. </span>An Application: Approximation and Optimization</a>
        </nav>
        <div class="mdl-layout-spacer"></div>
        <nav class="mdl-navigation">
        
<form class="form-inline pull-sm-right" action="../search.html" method="get">
      <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">
        <label id="quick-search-icon" class="mdl-button mdl-js-button mdl-button--icon"  for="waterfall-exp">
          <i class="material-icons">search</i>
        </label>
        <div class="mdl-textfield__expandable-holder">
          <input class="mdl-textfield__input" type="text" name="q"  id="waterfall-exp" placeholder="Search" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </div>
      </div>
      <div class="mdl-tooltip" data-mdl-for="quick-search-icon">
      Quick search
      </div>
</form>
        
<a id="button-show-source"
    class="mdl-button mdl-js-button mdl-button--icon"
    href="../_sources/chapters/ch11_application_optimization.rst.txt" rel="nofollow">
  <i class="material-icons">code</i>
</a>
<div class="mdl-tooltip" data-mdl-for="button-show-source">
Show Source
</div>
        </nav>
    </div>
    <div class="mdl-layout__header-row header-links">
      <div class="mdl-layout-spacer"></div>
      <nav class="mdl-navigation">
          
              <a  class="mdl-navigation__link" href="https://pp4e-book.github.io/pp4e-book.pdf">
                  <i class="fas fa-file-pdf"></i>
                  PDF
              </a>
          
              <a  class="mdl-navigation__link" href="https://github.com/pp4e-book/source">
                  <i class="fab fa-github"></i>
                  Github
              </a>
          
              <a  class="mdl-navigation__link" href="https://pp4e-book.github.io/chapters/all_notebooks.zip">
                  <i class="fas fa-download"></i>
                  All Notebooks
              </a>
          
              <a  class="mdl-navigation__link" href="https://ceng240.github.io/">
                  <i class="fas fa-user-graduate"></i>
                  Course
              </a>
      </nav>
    </div>
</header><header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../index.html">
              <img class="logo" src="../_static/logo-with-text.png" alt="Programming with Python for Engineers"/>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="ch0_preface.html">Preface</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ch1_computer_organization.html">1. Basic Computer Organization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch2_programming.html">2. A Broad Look at Programming and Programming Languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch3_data_representation.html">3. Representation of Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch4_dive_into_python.html">4. Dive into Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch5_conditional_and_repetitive.html">5. Conditional and Repetitive Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch6_functions.html">6. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch7_OOP.html">7. A Gentle Introduction to Object-Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch8_file_handling.html">8. File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch9_error_handling.html">9. Error Handling and Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch10_scientific_libraries.html">10. Scientific and Engineering Libraries</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">11. An Application: Approximation and Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch12_regression.html">12. An Application: Solving a Simple Regression Problem</a></li>
</ul>

            </nav>
        
        </div>
    
</header>
        <main class="mdl-layout__content" tabIndex="0">

	<script type="text/javascript" src="../_static/sphinx_materialdesign_theme.js "></script>
    <header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../index.html">
              <img class="logo" src="../_static/logo-with-text.png" alt="Programming with Python for Engineers"/>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="ch0_preface.html">Preface</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ch1_computer_organization.html">1. Basic Computer Organization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch2_programming.html">2. A Broad Look at Programming and Programming Languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch3_data_representation.html">3. Representation of Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch4_dive_into_python.html">4. Dive into Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch5_conditional_and_repetitive.html">5. Conditional and Repetitive Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch6_functions.html">6. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch7_OOP.html">7. A Gentle Introduction to Object-Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch8_file_handling.html">8. File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch9_error_handling.html">9. Error Handling and Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch10_scientific_libraries.html">10. Scientific and Engineering Libraries</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">11. An Application: Approximation and Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch12_regression.html">12. An Application: Solving a Simple Regression Problem</a></li>
</ul>

            </nav>
        
        </div>
    
</header>

    <div class="document">
        <div class="page-content" role="main">
        
  <div class="section" id="an-application-approximation-and-optimization">
<h1><span class="section-number">11. </span>An Application: Approximation and Optimization<a class="headerlink" href="#an-application-approximation-and-optimization" title="Permalink to this headline">Â¶</a><a href="https://colab.research.google.com/github/pp4e-book/pp4e-book.github.io/blob/master/chapters/ch11_application_optimization.ipynb" onclick="captureOutboundLink('https://colab.research.google.com/github/['pp4e-book/pp4e-book.github.io']/blob/master/chapters/ch11_application_optimization.ipynb'); return false;"> <button style="float:right", id="Colab" class="mdl-button mdl-js-button mdl-button--primary mdl-js-ripple-effect"> <i class=" fas fa-external-link-alt"></i> Colab </button></a><div class="mdl-tooltip" data-mdl-for="Colab"> Open the notebook in Colab</div></h1>
<p><em>(C) Copyright Notice: This chapter is part of the book available
at</em><a class="reference external" href="https://pp4e-book.github.io/">https://pp4e-book.github.io/</a><em>and copying, distributing, modifying
it requires explicit permission from the authors. See the book page for
details:</em><a class="reference external" href="https://pp4e-book.github.io/">https://pp4e-book.github.io/</a></p>
<p>In this chapter, as an application for programming with Python, we will
cover some mathematical methods widely used in many disciplines. We will
start with Taylor Series for approximating a function. We will then see
Newtonâs method for finding the roots of a function <span class="math notranslate nohighlight">\(f(x)\)</span>, which
can also be considered as an application of Taylor series. Finally, we
will cover how we can extend Newtonâs method for finding the minimum of
a function.</p>
<div class="section" id="approximating-functions-with-taylor-series">
<h2><span class="section-number">11.1. </span>Approximating Functions with Taylor Series<a class="headerlink" href="#approximating-functions-with-taylor-series" title="Permalink to this headline">Â¶</a></h2>
<p>In some engineering or scientific problems, we have limited access to a
function: We might be provided only the value of the function or its
derivatives at certain input values and we might be required to make
estimations (approximations) about the values of the function at other
input values. Taylorâs series is one method that provides us a very
elegant solution for approximating a function.</p>
<p>The Taylor series of a function <span class="math notranslate nohighlight">\(f(\cdot)\)</span> is essentially an
infinite sum of terms that converges to the value of the function at
<span class="math notranslate nohighlight">\(x\)</span>, i.e.Â <span class="math notranslate nohighlight">\(f(x)\)</span>. In more formal terms:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-0">
<span class="eqno">(11.1.1)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-0" title="Permalink to this equation">Â¶</a></span>\[f(x) = f(a) + \frac{f'(a)}{1!}(x-a) + \frac{f''(a)}{2!}(x-a)^2 + \frac{f'''(a)}{3!}(x-a)^3 ...\]</div>
<p>which can be re-written in a more compact form:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-1">
<span class="eqno">(11.1.2)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-1" title="Permalink to this equation">Â¶</a></span>\[f(x) = \sum_{n=0}^\infty \frac{f^{(n)}(a)}{n!}(x-a)^n .\]</div>
<p>In the limit (<span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span>), <span class="math notranslate nohighlight">\(f(x)\)</span> will be equal to
its Taylor series. However, in realistic applications, it is impractical
to take <span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span>. In practice, we take the first
<span class="math notranslate nohighlight">\(m\)</span> terms of the series and approximate the function with this:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-2">
<span class="eqno">(11.1.3)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-2" title="Permalink to this equation">Â¶</a></span>\[f(x) \approx f(a) + \frac{f'(a)}{1!}(x-a) + \frac{f''(a)}{2!}(x-a)^2 + \frac{f'''(a)}{3!}(x-a)^3 ... + \frac{f^{(m)}(a)}{m!}(x-a)^m,\]</div>
<p>ignoring the terms for <span class="math notranslate nohighlight">\(n &gt; m\)</span>.</p>
<p>Note that the denominator (<span class="math notranslate nohighlight">\(n!\)</span>) gets large values quickly when
<span class="math notranslate nohighlight">\(n\)</span> gets large. Therefore, higher-order terms in the Taylor series
are likely to be very small values. For this reason, taking the first
<span class="math notranslate nohighlight">\(m\)</span> terms in the series do provide sufficient approximations to
<span class="math notranslate nohighlight">\(f(x)\)</span> in practice.</p>
<p>We can provide some intuition for the Taylor Series as follows: If we
know the value of function <span class="math notranslate nohighlight">\(f\)</span> at <span class="math notranslate nohighlight">\(x=a\)</span>, then we can
calculate the value of the function at any other value of <span class="math notranslate nohighlight">\(x\)</span> as
long as we know all (or the first <span class="math notranslate nohighlight">\(m\)</span>) derivatives of the function
at <span class="math notranslate nohighlight">\(x=a\)</span>, i.e.Â <span class="math notranslate nohighlight">\(f^{(n)}(a)\)</span> for <span class="math notranslate nohighlight">\(n=1, ..., \infty\)</span> (or
<span class="math notranslate nohighlight">\(m\)</span>). To see this, consider just the Taylor Series approximation
with the first two terms:
<span class="math notranslate nohighlight">\(f(x) \approx f(a) + \frac{f'(a)}{1!}(x-a)\)</span>, which is illustrated
in <a class="reference internal" href="#ch11-taylor-motivation"><span class="std std-numref">Fig. 11.1.1</span></a>.</p>
<div class="figure align-default" id="id2">
<span id="ch11-taylor-motivation"></span><img alt="../_images/ch11_taylor_motivation.png" src="../_images/ch11_taylor_motivation.png" />
<p class="caption"><span class="caption-number">Fig. 11.1.1 </span><span class="caption-text">Taylor Series approximates a function by using its derivatives. The
drawing illustrates <span class="math notranslate nohighlight">\(f(x_0)\)</span> being approximated (with the first
term of the Taylor Series only) by the known value of the function
<span class="math notranslate nohighlight">\(f(a)\)</span> and the derivative <span class="math notranslate nohighlight">\(f'(a)\)</span> at that point. Green
line denotes the tangent line at <span class="math notranslate nohighlight">\(f(a)\)</span> whose slope is
<span class="math notranslate nohighlight">\(f'(a)\)</span>.</span><a class="headerlink" href="#id2" title="Permalink to this image">Â¶</a></p>
</div>
<div class="section" id="taylor-series-example-in-python">
<h3><span class="section-number">11.1.1. </span>Taylor Series Example in Python<a class="headerlink" href="#taylor-series-example-in-python" title="Permalink to this headline">Â¶</a></h3>
<p>Let us take a âsimpleâ function, namely <span class="math notranslate nohighlight">\(f(x)=x^3\)</span>, and
approximate it with a few terms of the Taylor Series expansion:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># x^3 function</span>
<span class="k">def</span> <span class="nf">xcube_a</span><span class="p">(</span><span class="n">a</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">a</span>

<span class="c1"># Function for the derivatives of x^3</span>
<span class="c1">#   Inputs: n (integer) =&gt; derivative degree</span>
<span class="c1">#           a (real number) =&gt; constant at which derivative is calculated</span>
<span class="k">def</span> <span class="nf">xcube_nth_deriv_at_a</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">a</span> <span class="c1"># 1st derivative: 3x*x</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="k">return</span> <span class="mi">6</span><span class="o">*</span><span class="n">a</span>   <span class="c1"># 2nd derivative: 6x</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="k">return</span> <span class="mi">6</span>     <span class="c1"># 3rd derivative: 6</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>  <span class="k">return</span> <span class="mi">0</span>     <span class="c1"># nth derivative (n&gt;3): 0</span>

<span class="c1"># Factorial function</span>
<span class="k">def</span> <span class="nf">fact</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">n</span><span class="o">*</span><span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Function approximating x^3 with m terms of the Taylor series</span>
<span class="k">def</span> <span class="nf">xcube_approx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
  <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c1"># You can try different a values</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">xcube_a</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">+=</span> <span class="n">xcube_nth_deriv_at_a</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let us evaluate how close our approximation is for various values of m.</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Let us compare the approximations for a set of x values:</span>
<span class="n">x_vector</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Find the approximations for our x values:</span>
<span class="n">y_m_1</span><span class="o">=</span><span class="p">[</span><span class="n">xcube_approx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_vector</span><span class="p">]</span>
<span class="n">y_m_2</span><span class="o">=</span><span class="p">[</span><span class="n">xcube_approx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_vector</span><span class="p">]</span>
<span class="n">y_m_3</span><span class="o">=</span><span class="p">[</span><span class="n">xcube_approx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_vector</span><span class="p">]</span>

<span class="c1"># We have our ground truth (correct) values:</span>
<span class="n">y_correct</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_vector</span><span class="p">]</span>

<span class="c1"># Let&#39;s plot the results and the correct function (x**3)</span>
<span class="c1"># We have a multi-plot plot, so we will use subplot() function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">4</span> <span class="c1"># Sets the figure size</span>

<span class="c1"># First subplot: The correct (original) function that we are approximating</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vector</span><span class="p">,</span><span class="n">y_correct</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x**3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$x^3$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>

<span class="c1"># Second subplot: Approximation with one term</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vector</span><span class="p">,</span><span class="n">y_m_1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$x^3$ Approx. with $m$=1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>

<span class="c1"># Third subplot: Approximation with two terms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vector</span><span class="p">,</span><span class="n">y_m_2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$x^3$ Approx. with $m$=2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>

<span class="c1"># Fourth subplot: Approximation with three terms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vector</span><span class="p">,</span><span class="n">y_m_3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$x^3$ Approx. with $m$=3&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../_images/output_ch11_application_optimization_64320a_2_1.png" src="../_images/output_ch11_application_optimization_64320a_2_1.png" />
</div>
</div>
</div>
<div class="section" id="finding-the-roots-of-a-function">
<h2><span class="section-number">11.2. </span>Finding the Roots of a Function<a class="headerlink" href="#finding-the-roots-of-a-function" title="Permalink to this headline">Â¶</a></h2>
<p>Let us assume that we have a non-linear, continuous function
<span class="math notranslate nohighlight">\(f(x)\)</span> that intersects the horizontal axis as in
<a class="reference internal" href="#ch11-function-f"><span class="std std-numref">Fig. 11.2.1</span></a>. We are interested in finding
<span class="math notranslate nohighlight">\(r_0, ..., r_n\)</span> such that <span class="math notranslate nohighlight">\(f(r_i)=0\)</span>. We call these
intersections (<span class="math notranslate nohighlight">\(r_0, r_1, r_2\)</span> in <a class="reference internal" href="#ch11-function-f"><span class="std std-numref">Fig. 11.2.1</span></a>) the
roots of function <span class="math notranslate nohighlight">\(f()\)</span>.</p>
<p>For many problems in Engineering and Mathematics, finding the values of
these intersections is very useful. For example, many problems requiring
solutions to equations like <span class="math notranslate nohighlight">\(g(x)=h(x)\)</span> can be reformulated as a
root finding problem for <span class="math notranslate nohighlight">\(g(x)-h(x)=0\)</span>.</p>
<div class="figure align-default" id="id3">
<span id="ch11-function-f"></span><img alt="../_images/ch11_function_f.png" src="../_images/ch11_function_f.png" />
<p class="caption"><span class="caption-number">Fig. 11.2.1 </span><span class="caption-text">Finding the roots of a function <span class="math notranslate nohighlight">\(f(x)\)</span> means finding
<span class="math notranslate nohighlight">\(r_0, .., r_n\)</span> for which the function is zero,
<span class="math notranslate nohighlight">\(f(r_i)=0\)</span>.</span><a class="headerlink" href="#id3" title="Permalink to this image">Â¶</a></p>
</div>
<div class="section" id="newtons-method-for-finding-the-roots">
<h3><span class="section-number">11.2.1. </span>Newtonâs Method for Finding the Roots<a class="headerlink" href="#newtons-method-for-finding-the-roots" title="Permalink to this headline">Â¶</a></h3>
<p>Newtonâs method is one of the many methods for finding the roots of a
function. It is a very common method that randomly starts at an
<span class="math notranslate nohighlight">\(x_0\)</span> value and iteratively takes one step at a time towards a
root. The method can be described with the following iterative steps:</p>
<p><strong>Step 1</strong>: Set an iteration variable, <span class="math notranslate nohighlight">\(i\)</span>, to 0. Initialize
<span class="math notranslate nohighlight">\(x_i\)</span> randomly; however, if you have a good guess, it is always
better to initialize <span class="math notranslate nohighlight">\(x_i\)</span> with it. For our example function
<span class="math notranslate nohighlight">\(f(x)\)</span> in <a class="reference internal" href="#ch11-function-f"><span class="std std-numref">Fig. 11.2.1</span></a>, see the selected
<span class="math notranslate nohighlight">\(x_i\)</span> in <a class="reference internal" href="#ch11-1-step"><span class="std std-numref">Fig. 11.2.2</span></a>.</p>
<div class="figure align-default" id="id4">
<span id="ch11-1-step"></span><img alt="../_images/ch11_function_f_step1.png" src="../_images/ch11_function_f_step1.png" />
<p class="caption"><span class="caption-number">Fig. 11.2.2 </span><span class="caption-text">One initial step of Newtonâs method. The tangent line at
<span class="math notranslate nohighlight">\(f(x_0)\)</span> is used to calculate the next value of <span class="math notranslate nohighlight">\(x_i\)</span>,
getting us closer to a root.</span><a class="headerlink" href="#id4" title="Permalink to this image">Â¶</a></p>
</div>
<p><strong>Step 2</strong>: Find the intersection of the tangent line at <span class="math notranslate nohighlight">\(x_i\)</span>
with the horizontal axis. The tangent line to the function at
<span class="math notranslate nohighlight">\(x_i\)</span> is illustrated as the green dashed line in Figure 11.3. This
line can be easily derived using <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(f'(x_i)\)</span>.</p>
<p>Let us use <span class="math notranslate nohighlight">\(x_{i+1}\)</span> to denote the intersection of the tangent
line with the horizontal axis. Using the definition of the derivative
and simple geometric rules, we can easily show that <span class="math notranslate nohighlight">\(x_{i+1}\)</span>
satisfies the following:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-3">
<span class="eqno">(11.2.1)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-3" title="Permalink to this equation">Â¶</a></span>\[\frac{x_{i}-x_{i+1}}{f(x_i)} = \frac{1}{f'(x_i)},\]</div>
<p>with which we can formulate how we can find <span class="math notranslate nohighlight">\(x_{i+1}\)</span> as follows:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-4">
<span class="eqno">(11.2.2)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-4" title="Permalink to this equation">Â¶</a></span>\[x_{i+1} = x_i - \frac{f(x_i)}{f'(x_i)}.\]</div>
<p><strong>Step 3</strong>: Repeat Step 2 by replacing <span class="math notranslate nohighlight">\(x_i \leftarrow x_{i+1}\)</span>
until âconvergenceâ.</p>
<p>The intuition behind the Newtonâs method is simple: For a linear
function such as <span class="math notranslate nohighlight">\(y=ax+b\)</span>, the root is <span class="math notranslate nohighlight">\(r=-b/a\)</span>, which can
be easily derived from the slope and a known <span class="math notranslate nohighlight">\(y\)</span> value. For a
non-linear function <span class="math notranslate nohighlight">\(y=f(x)\)</span>, we make an approximation by assuming
<span class="math notranslate nohighlight">\(f()\)</span> to be linear at point <span class="math notranslate nohighlight">\(x_0\)</span> and use the slope of this
linear approximation to find a new <span class="math notranslate nohighlight">\(x_0\)</span> that is closer to the
root.</p>
</div>
<div class="section" id="misc-details-on-newtons-method-for-the-curious">
<h3><span class="section-number">11.2.2. </span>Misc Details on Newtonâs Method for the Curious<a class="headerlink" href="#misc-details-on-newtons-method-for-the-curious" title="Permalink to this headline">Â¶</a></h3>
<p>It is not possible to cover all aspects of these elegant methods in
detail. However, it would be a shame to skip the following details and
hide them from a curious mind.</p>
<p><strong>The Taylor Series Perspective for Newtonâs Method</strong></p>
<p>Newtonâs method for finding a root of a function <span class="math notranslate nohighlight">\(f()\)</span> works
iteratively starting from an initial value <span class="math notranslate nohighlight">\(x_0\)</span> by using the
first-order expansion of <span class="math notranslate nohighlight">\(f()\)</span> around <span class="math notranslate nohighlight">\(x_i\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-5">
<span class="eqno">(11.2.3)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-5" title="Permalink to this equation">Â¶</a></span>\[f(x_{i+1}) \approx f(x_i) + \frac{f'(x_i)}{1!}(x_{i+1}-x_i),\]</div>
<p>which can be simplified by rewriting <span class="math notranslate nohighlight">\(x_{i+1}=x_i+\delta\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-6">
<span class="eqno">(11.2.4)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-6" title="Permalink to this equation">Â¶</a></span>\[f(x_{i}+\delta) \approx f(x_i) + \frac{f'(x_i)}{1!}\delta.\]</div>
<p>We are interested in finding <span class="math notranslate nohighlight">\(\delta\)</span> such that the approximation
is equal to zero, in other words:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-7">
<span class="eqno">(11.2.5)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-7" title="Permalink to this equation">Â¶</a></span>\[0 = f(x_i) + \frac{f'(x_i)}{1!}\delta,\]</div>
<p>which yields the delta value for which the approximation is zero:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-8">
<span class="eqno">(11.2.6)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-8" title="Permalink to this equation">Â¶</a></span>\[\delta = -\frac{f(x_i)}{f'(x_i)}.\]</div>
<p>Plugging this into <span class="math notranslate nohighlight">\(x_{i+1}=x_i + \delta\)</span>, we obtain the equation
for calculating the next value in the sequence towards a minimum of
function <span class="math notranslate nohighlight">\(f()\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-9">
<span class="eqno">(11.2.7)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-9" title="Permalink to this equation">Â¶</a></span>\[x_{i+1} \leftarrow x_i - \frac{f(x_i)}{f'(x_i)}.\]</div>
<p><strong>Notes on Convergence</strong></p>
<p>A careful reader should have identified two important issues with
Newtonâs method:</p>
<p>1- How can we be sure that this method converges to a solution, i.e.Â a
root?</p>
<p>If function <span class="math notranslate nohighlight">\(f()\)</span> satisfies certain conditions, then we can
guarantee that Newtonâs method converges to a root. The details of these
conditions and the proofs are beyond the scope of the book and the
interested reader can check
e.g.Â <a class="reference external" href="https://en.wikipedia.org/wiki/Newton%27s_method#Analysis">Wikipedia</a>.</p>
<p>To be on the safe side, we can limit the maximum number of steps that
can we take and use the calculated value at the end.</p>
<p>2- If convergence can be guaranteed, how can we know that we have
converged to a solution?</p>
<p>A common technique in such iterative algorithms is to check whether the
difference between the consecutive values is tiny. In our case, if
<span class="math notranslate nohighlight">\(|x_{i+1}-x_i| &lt; \epsilon\)</span>, where <span class="math notranslate nohighlight">\(\epsilon\)</span> is a very small
number, then we can assume that consecutive steps do not lead to much
change in <span class="math notranslate nohighlight">\(x_i\)</span> and therefore, we can stop our algorithm. Of
course, the value of <span class="math notranslate nohighlight">\(\epsilon\)</span> will be critical in determining
how many iterations are needed to âconvergeâ to a result.</p>
<p><strong>Notes on Multiple Roots</strong></p>
<p>Newtonâs method converges only to a single root based on the initial
value <span class="math notranslate nohighlight">\(x_0\)</span>. In order to find other roots, the algorithm needs to
be executed with a different value of <span class="math notranslate nohighlight">\(x_0\)</span>, which will hopefully
lead to a different root than the ones that we have identified before.</p>
<p>Since our knowledge about <span class="math notranslate nohighlight">\(f()\)</span> or its roots is limited, running
the algorithm for <span class="math notranslate nohighlight">\(N\)</span> times for different values of <span class="math notranslate nohighlight">\(x_0\)</span> is
the only option. If, on the other hand, we knew roughly the ranges of
<span class="math notranslate nohighlight">\(x\)</span> where function <span class="math notranslate nohighlight">\(f()\)</span> might have roots, then we could use
this knowledge to choose better <span class="math notranslate nohighlight">\(x_0\)</span> values.</p>
</div>
<div class="section" id="newtons-method-in-python">
<h3><span class="section-number">11.2.3. </span>Newtonâs Method in Python<a class="headerlink" href="#newtons-method-in-python" title="Permalink to this headline">Â¶</a></h3>
<p>Let us implement Newtonâs method in Python and try to find the roots of
an example function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_deriv</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use Newton&#39;s method to find a root of function f, given its derivative f_deriv.</span>
<span class="sd">    Inputs: f =&gt; function</span>
<span class="sd">            f_deriv =&gt; derivative of function f</span>
<span class="sd">            x_0 =&gt; initial x value</span>
<span class="sd">            max_steps =&gt; maximum number of iterative steps (default: 10)</span>
<span class="sd">            delta =&gt; if |x_i+1 - x_i| &lt; delta, then assume convergence</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">x_old</span> <span class="o">=</span> <span class="n">x_0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_steps</span><span class="p">):</span>
    <span class="c1"># Step 2</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">x_new</span> <span class="o">=</span> <span class="n">x_old</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x_old</span><span class="p">)</span> <span class="o">/</span> <span class="n">f_deriv</span><span class="p">(</span><span class="n">x_old</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
      <span class="c1"># Encountered division-by-zero, return None</span>
      <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iteration &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;. (x_old, x_new): &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">x_old</span><span class="p">,</span> <span class="n">x_new</span><span class="p">),</span> <span class="s2">&quot; |x_new-x_old|: &quot;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_new</span><span class="o">-</span><span class="n">x_old</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_new</span><span class="o">-</span><span class="n">x_old</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">delta</span><span class="p">:</span> <span class="k">break</span>

    <span class="c1"># Step 3</span>
    <span class="n">x_old</span> <span class="o">=</span> <span class="n">x_new</span>

  <span class="k">return</span> <span class="n">x_new</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let us pick a function and test our implementation</span>

<span class="c1"># Assume that our function is: f(x) = x^2 - 4</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x_i</span><span class="p">):</span> <span class="k">return</span> <span class="n">x_i</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span>

<span class="c1"># This is the derivative, f&#39;(x_i)</span>
<span class="k">def</span> <span class="nf">f_deriv</span><span class="p">(</span><span class="n">x_i</span><span class="p">):</span> <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x_i</span>

<span class="c1"># Let us draw our function first</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">draw_f</span><span class="p">():</span>
  <span class="c1"># Uniformly sample 50 x values between -5 and 5:</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$f(x)=x^2 - 4$&#39;</span><span class="p">)</span>

<span class="n">draw_f</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../_images/output_ch11_application_optimization_64320a_5_0.png" src="../_images/output_ch11_application_optimization_64320a_5_0.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let us test our solution with 10 random initial values</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">draw_f</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="n">x_0</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># A random integer in [-5, 5]</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">find_root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_deriv</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">r</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">):</span> <span class="k">continue</span> <span class="c1"># Diverged or divison-by-zero, ignore</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trial&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot; ended with root: &quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="s2">&quot; value at root, f(r): &quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trial</span> <span class="mi">0</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.000000000000002</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">8.881784197001252e-15</span>
<span class="n">trial</span> <span class="mi">1</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="o">-</span><span class="mf">2.000000000000002</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">8.881784197001252e-15</span>
<span class="n">trial</span> <span class="mi">2</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.0</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">0.0</span>
<span class="n">trial</span> <span class="mi">3</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.000000000026214</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">1.0485656787295738e-10</span>
<span class="n">trial</span> <span class="mi">4</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.000000000026214</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">1.0485656787295738e-10</span>
<span class="n">trial</span> <span class="mi">5</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="o">-</span><span class="mf">2.000000000000002</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">8.881784197001252e-15</span>
<span class="n">trial</span> <span class="mi">6</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="o">-</span><span class="mf">2.000000000000002</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">8.881784197001252e-15</span>
<span class="n">trial</span> <span class="mi">7</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.000000000026214</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">1.0485656787295738e-10</span>
<span class="n">trial</span> <span class="mi">8</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.000000000000002</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">8.881784197001252e-15</span>
<span class="n">trial</span> <span class="mi">9</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.0</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">0.0</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../_images/output_ch11_application_optimization_64320a_6_1.png" src="../_images/output_ch11_application_optimization_64320a_6_1.png" />
</div>
</div>
<div class="section" id="newtons-method-in-scipy">
<h3><span class="section-number">11.2.4. </span>Newtonâs Method in SciPy<a class="headerlink" href="#newtons-method-in-scipy" title="Permalink to this headline">Â¶</a></h3>
<p>Let us see how we can use Newtonâs method from the SciPy library (from
Chapter 10) to find the roots of a function. Note that we do not need to
provide the derivative of the function to SciPy. It used numerical
differentiation to calculate the derivative for us.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">newton</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">draw_f</span><span class="p">()</span> <span class="c1"># Defined above</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="n">x_0</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># A random integer in [-5, 5]</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">r</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">):</span> <span class="k">continue</span> <span class="c1"># Diverged or divison-by-zero, ignore</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trial&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot; ended with root: &quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="s2">&quot; value at root, f(r): &quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trial</span> <span class="mi">0</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.000000075022694</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">3.000907806693931e-07</span>
<span class="n">trial</span> <span class="mi">1</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="o">-</span><span class="mf">2.0000000032851974</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">1.3140789789645169e-08</span>
<span class="n">trial</span> <span class="mi">2</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.000000075022694</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">3.000907806693931e-07</span>
<span class="n">trial</span> <span class="mi">3</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.0000000032851974</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">1.3140789789645169e-08</span>
<span class="n">trial</span> <span class="mi">5</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="o">-</span><span class="mf">2.0</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">0.0</span>
<span class="n">trial</span> <span class="mi">6</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="o">-</span><span class="mf">2.0000000003832255</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">1.532901805489928e-09</span>
<span class="n">trial</span> <span class="mi">7</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="mf">2.000000075022694</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">3.000907806693931e-07</span>
<span class="n">trial</span> <span class="mi">8</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="o">-</span><span class="mf">2.0000000003832255</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">1.532901805489928e-09</span>
<span class="n">trial</span> <span class="mi">9</span>  <span class="n">ended</span> <span class="k">with</span> <span class="n">root</span><span class="p">:</span>  <span class="o">-</span><span class="mf">2.0000000032851974</span>  <span class="n">value</span> <span class="n">at</span> <span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>  <span class="mf">1.3140789789645169e-08</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../_images/output_ch11_application_optimization_64320a_8_1.png" src="../_images/output_ch11_application_optimization_64320a_8_1.png" />
</div>
</div>
</div>
<div class="section" id="finding-a-minimum-of-functions">
<h2><span class="section-number">11.3. </span>Finding a Minimum of Functions<a class="headerlink" href="#finding-a-minimum-of-functions" title="Permalink to this headline">Â¶</a></h2>
<p>An important problem frequently encountered in many disciplines is
optimization. In such problems, as illustrated in
<a class="reference internal" href="#ch11-f-minimum"><span class="std std-numref">Fig. 11.3.1</span></a>, we have a function <span class="math notranslate nohighlight">\(f(x)\)</span> and we wish
to find its minimum value (<span class="math notranslate nohighlight">\(f^*\)</span>):</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-10">
<span class="eqno">(11.3.1)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-10" title="Permalink to this equation">Â¶</a></span>\[f^* \leftarrow \min_{x\in\mathbb{R}} f(x),\]</div>
<p>or the value (<span class="math notranslate nohighlight">\(x^*\)</span>) that minimizes it:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-11">
<span class="eqno">(11.3.2)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-11" title="Permalink to this equation">Â¶</a></span>\[x^* \leftarrow \arg\min_{x\in\mathbb{R}} f(x).\]</div>
<p>In many practical settings, the functions that we work with may have
multiple minima. In such a case, the minimum point, <span class="math notranslate nohighlight">\(x^*\)</span>, can be
either (i) a <em>global minimum</em> such that there may <em>not</em> be any other
point <span class="math notranslate nohighlight">\(\hat{x}\)</span> with <span class="math notranslate nohighlight">\(f(\hat{x}) &lt; f(x^*)\)</span>, (ii) a <em>local
minimum</em> such that <span class="math notranslate nohighlight">\(x^*\)</span> is the minimum of a local neighborhood.</p>
<p>The methods generally exploit two important cues: (i) At a minimum, the
sign of the first-order derivative changes (on the sides of the
minimum). (ii) At a minimum, the first derivative is zero.</p>
<div class="figure align-default" id="id5">
<span id="ch11-f-minimum"></span><img alt="../_images/ch11_function_f_minimum.png" src="../_images/ch11_function_f_minimum.png" />
<p class="caption"><span class="caption-number">Fig. 11.3.1 </span><span class="caption-text">Finding a minimum of a function <span class="math notranslate nohighlight">\(f(x)\)</span> means finding
<span class="math notranslate nohighlight">\(x^*\)</span> for which <span class="math notranslate nohighlight">\(f(x^*)\)</span> is the lowest value (or lower
than all others in a local neighborhood) that function <span class="math notranslate nohighlight">\(f()\)</span>
can take.</span><a class="headerlink" href="#id5" title="Permalink to this image">Â¶</a></p>
</div>
<div class="section" id="newtons-method-for-finding-the-minimum-of-a-function">
<h3><span class="section-number">11.3.1. </span>Newtonâs Method for Finding the Minimum of a Function<a class="headerlink" href="#newtons-method-for-finding-the-minimum-of-a-function" title="Permalink to this headline">Â¶</a></h3>
<p>Similar to find the root of a function explained in Section 11.2,
Newtonâs method for finding a local minimum of a function <span class="math notranslate nohighlight">\(f()\)</span>
works iteratively starting from an initial value <span class="math notranslate nohighlight">\(x_0\)</span> by using
the <em>second-order expansion</em> of <span class="math notranslate nohighlight">\(f()\)</span> around <span class="math notranslate nohighlight">\(x_i\)</span> this
time:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-12">
<span class="eqno">(11.3.3)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-12" title="Permalink to this equation">Â¶</a></span>\[f(x_{i+1}) \approx f(x_i) + \frac{f'(x_i)}{1!}(x_{i+1}-x_i)+ \frac{f''(x_i)}{2!}(x_{i+1}-x_i)^2,\]</div>
<p>which can be simplified by rewriting <span class="math notranslate nohighlight">\(x_{i+1}=x_i+\delta\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-13">
<span class="eqno">(11.3.4)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-13" title="Permalink to this equation">Â¶</a></span>\[f(x_{i}+\delta) \approx f(x_i) + \frac{f'(x_i)}{1!}\delta+ \frac{f''(x_i)}{2!}\delta^2.\]</div>
<p>We are interested in finding <span class="math notranslate nohighlight">\(\delta\)</span> that minimizes the
approximation. This can be obtained by setting the first derivative to
zero:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-14">
<span class="eqno">(11.3.5)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-14" title="Permalink to this equation">Â¶</a></span>\[\frac{d}{d\delta} \left(f(x_i) + \frac{f'(x_i)}{1!}\delta+ \frac{f''(x_i)}{2!}\delta^2\right) = f'(x_i)+f''(x_i)\delta = 0,\]</div>
<p>which yields the delta value minimizing the approximation:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-15">
<span class="eqno">(11.3.6)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-15" title="Permalink to this equation">Â¶</a></span>\[\delta = -\frac{f'(x_i)}{f''(x_i)}.\]</div>
<p>Plugging this into <span class="math notranslate nohighlight">\(x_{i+1}=x_i + \delta\)</span>, we obtain the equation
for calculating the next value in the sequence towards a minimum of
function <span class="math notranslate nohighlight">\(f()\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-16">
<span class="eqno">(11.3.7)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-16" title="Permalink to this equation">Â¶</a></span>\[x_{i+1} \leftarrow x_i - \frac{f'(x_i)}{f''(x_i)}.\]</div>
</div>
<div class="section" id="misc-details-for-the-curious">
<h3><span class="section-number">11.3.2. </span>Misc Details for the Curious<a class="headerlink" href="#misc-details-for-the-curious" title="Permalink to this headline">Â¶</a></h3>
<p><strong>Notes on Convergence</strong></p>
<p>Newtonâs method can converge to a local minimum if (i) <span class="math notranslate nohighlight">\(f\)</span> is a
strongly convex function with Lipschitz Hessian and (ii) <span class="math notranslate nohighlight">\(x_0\)</span> is
close enough to <span class="math notranslate nohighlight">\(x^* \leftarrow \arg\min_{x\in\mathbb{R}} f(x)\)</span>.
More formally when:</p>
<div class="math notranslate nohighlight" id="equation-chapters-ch11-application-optimization-17">
<span class="eqno">(11.3.8)<a class="headerlink" href="#equation-chapters-ch11-application-optimization-17" title="Permalink to this equation">Â¶</a></span>\[\|x_{i+1}-x^*\| \leq {\frac {1}{2}}\|x_{i}-x_{*}\|^{2}. \qquad \forall i\geq 0.\]</div>
<p>In plain English, (i) we have a âwell-shapedâ local neighborhood in
which we can talk about the concept of a minimum, (ii) our initial
value, <span class="math notranslate nohighlight">\(x_0\)</span>, is inside such a neighborhood.</p>
<p><strong>Notes on Multiple Minima</strong></p>
<p>Similar to the case for root finding, Newtonâs method converges only to
a single minimum based on the initial value <span class="math notranslate nohighlight">\(x_0\)</span>. In order to
find other minima, the algorithm needs to be executed with a different
value of <span class="math notranslate nohighlight">\(x_0\)</span>, which will hopefully lead to a different minimum
than the ones that we have identified before.</p>
</div>
<div class="section" id="id1">
<h3><span class="section-number">11.3.3. </span>Newtonâs Method in Python<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h3>
<p>Now let us implement Newtonâs method for finding a minimum of a function
from scratch, in Python.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_local_min</span><span class="p">(</span><span class="n">f_deriv</span><span class="p">,</span> <span class="n">f_second_deriv</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use Newton&#39;s method to find a local minimum of function f, given its derivative f_deriv.</span>
<span class="sd">    Inputs: f =&gt; function</span>
<span class="sd">            f_deriv =&gt; derivative of function f</span>
<span class="sd">            x_0 =&gt; initial x value</span>
<span class="sd">            max_steps =&gt; maximum number of iterative steps (default: 10)</span>
<span class="sd">            delta =&gt; if |x_i+1 - x_i| &lt; delta, then assume convergence</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">x_old</span> <span class="o">=</span> <span class="n">x_0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_steps</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">x_new</span> <span class="o">=</span> <span class="n">x_old</span> <span class="o">-</span> <span class="n">f_deriv</span><span class="p">(</span><span class="n">x_old</span><span class="p">)</span> <span class="o">/</span> <span class="n">f_second_deriv</span><span class="p">(</span><span class="n">x_old</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
      <span class="c1"># Encountered division-by-zero, return None</span>
      <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iteration &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;. (x_old, x_new): &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">x_old</span><span class="p">,</span> <span class="n">x_new</span><span class="p">),</span> <span class="s2">&quot; |x_new-x_old|: &quot;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_new</span><span class="o">-</span><span class="n">x_old</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_new</span><span class="o">-</span><span class="n">x_old</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">delta</span><span class="p">:</span> <span class="k">break</span>

    <span class="c1"># Step 4</span>
    <span class="n">x_old</span> <span class="o">=</span> <span class="n">x_new</span>

  <span class="k">return</span> <span class="n">x_new</span>

<span class="c1"># Assume that our function is: f(x) = x^2 - 4</span>
<span class="k">def</span> <span class="nf">f_deriv</span><span class="p">(</span><span class="n">x_i</span><span class="p">):</span> <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x_i</span>
<span class="k">def</span> <span class="nf">f_second_deriv</span><span class="p">(</span><span class="n">x_i</span><span class="p">):</span> <span class="k">return</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let us test our solution with 10 random initial values</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">draw_f</span><span class="p">()</span> <span class="c1"># defined in Section 11.2</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="n">x_0</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># A random integer in [-5, 5]</span>
  <span class="n">x_min</span> <span class="o">=</span> <span class="n">find_local_min</span><span class="p">(</span><span class="n">f_deriv</span><span class="p">,</span> <span class="n">f_second_deriv</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x_min</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f_deriv</span><span class="p">(</span><span class="n">x_min</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">):</span> <span class="k">continue</span> <span class="c1"># Diverged or divison-by-zero, ignore</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trial&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;led to x_min: &quot;</span><span class="p">,</span> <span class="n">x_min</span><span class="p">,</span> <span class="s2">&quot;, f&#39;(x_min): &quot;</span><span class="p">,</span> <span class="n">f_deriv</span><span class="p">(</span><span class="n">x_min</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_min</span><span class="p">))</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trial</span> <span class="mi">0</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
<span class="n">trial</span> <span class="mi">1</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
<span class="n">trial</span> <span class="mi">2</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
<span class="n">trial</span> <span class="mi">3</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
<span class="n">trial</span> <span class="mi">4</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
<span class="n">trial</span> <span class="mi">5</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
<span class="n">trial</span> <span class="mi">6</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
<span class="n">trial</span> <span class="mi">7</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
<span class="n">trial</span> <span class="mi">8</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
<span class="n">trial</span> <span class="mi">9</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">0.0</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  0.0</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../_images/output_ch11_application_optimization_64320a_11_1.png" src="../_images/output_ch11_application_optimization_64320a_11_1.png" />
</div>
</div>
<div class="section" id="newtons-method-for-finding-minima-in-scipy">
<h3><span class="section-number">11.3.4. </span>Newtonâs Method for Finding Minima in SciPy<a class="headerlink" href="#newtons-method-for-finding-minima-in-scipy" title="Permalink to this headline">Â¶</a></h3>
<p>Unfortunately, Newtonâs method as explained in Section 11.3.1 does not
exist in SciPy. However, there are many alternatives and we will just
illustrate only one of them here.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize_scalar</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">draw_f</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="n">x_0</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># A random integer in [-5, 5]</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">minimize_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;golden&#39;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">})</span>
  <span class="n">x_min</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trial&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;led to x_min: &quot;</span><span class="p">,</span> <span class="n">x_min</span><span class="p">,</span> <span class="s2">&quot;, f&#39;(x_min): &quot;</span><span class="p">,</span> <span class="n">f_deriv</span><span class="p">(</span><span class="n">x_min</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_min</span><span class="p">))</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trial</span> <span class="mi">0</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
<span class="n">trial</span> <span class="mi">1</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
<span class="n">trial</span> <span class="mi">2</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
<span class="n">trial</span> <span class="mi">3</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
<span class="n">trial</span> <span class="mi">4</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
<span class="n">trial</span> <span class="mi">5</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
<span class="n">trial</span> <span class="mi">6</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
<span class="n">trial</span> <span class="mi">7</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
<span class="n">trial</span> <span class="mi">8</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
<span class="n">trial</span> <span class="mi">9</span> <span class="n">led</span> <span class="n">to</span> <span class="n">x_min</span><span class="p">:</span>  <span class="mf">1.4872654968309704e-08</span> <span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(x_min):  2.974530993661941e-08</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../_images/output_ch11_application_optimization_64320a_13_1.png" src="../_images/output_ch11_application_optimization_64320a_13_1.png" />
</div>
</div>
</div>
<div class="section" id="important-concepts">
<h2><span class="section-number">11.4. </span>Important Concepts<a class="headerlink" href="#important-concepts" title="Permalink to this headline">Â¶</a></h2>
<p>We would like our readers to have grasped the following crucial concepts
and keywords from this chapter:</p>
<ul class="simple">
<li><p>Taylor Series for function approximation.</p></li>
<li><p>Newtonâs method for finding the roots and the minima of functions.</p></li>
<li><p>Local minimum vs.Â global minimum.</p></li>
</ul>
</div>
<div class="section" id="further-reading">
<h2><span class="section-number">11.5. </span>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><p>Taylor Series:
<a class="reference external" href="https://openstax.org/books/calculus-volume-2/pages/6-3-taylor-and-maclaurin-series">https://openstax.org/books/calculus-volume-2/pages/6-3-taylor-and-maclaurin-series</a></p></li>
<li><p>Newtonâs Method:</p>
<ul>
<li><p><a class="reference external" href="https://openstax.org/books/calculus-volume-1/pages/4-9-newtons-method">https://openstax.org/books/calculus-volume-1/pages/4-9-newtons-method</a></p></li>
<li><p><a class="reference external" href="http://www.opentextbookstore.com/calc/2_7.pdf">http://www.opentextbookstore.com/calc/2_7.pdf</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="exercises">
<h2><span class="section-number">11.6. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li><p>For the Taylor series approximation of <span class="math notranslate nohighlight">\(x^3\)</span> in Section 11.1.1:</p>
<ol class="arabic simple">
<li><p>Discuss how and why the approximation is changing when we add more
terms.</p></li>
<li><p>Discuss why having 3 terms in the approximation yields a function
that is very close to the original function.</p></li>
<li><p>Write a Python code that checks whether an approximation is
exactly the same as the function being approximated. Use this code
to check whether using 3 terms in Taylor series expansion was
sufficient for approximating <span class="math notranslate nohighlight">\(x^3\)</span>.</p></li>
</ol>
</li>
<li><p>Approximate the <span class="math notranslate nohighlight">\(\sin\)</span> function using Taylor Series:</p>
<ol class="arabic simple">
<li><p>Approximate the <span class="math notranslate nohighlight">\(\sin\)</span> function with the Taylor Series
expansion by taking <span class="math notranslate nohighlight">\(a=0\)</span>. You will need the <span class="math notranslate nohighlight">\(n\)</span>th
derivative of <span class="math notranslate nohighlight">\(\sin\)</span>, which turns out to be simply
<span class="math notranslate nohighlight">\(\frac{d^{n}}{d x^{n}} \sin(x) = \sin(x+n\pi/2)\)</span>.</p></li>
<li><p>Plot the approximation for different number of terms (<span class="math notranslate nohighlight">\(m\)</span>):
1, 2, 3 and 4. Observe what happens when more terms are added to
the approximation.</p></li>
<li><p>Compare your approximation results to those we obtained for
<span class="math notranslate nohighlight">\(x^3\)</span>. Discuss the reasons for similarities and differences.</p></li>
</ol>
</li>
<li><p>Find the roots of the following functions using Newtonâs Method:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(f(x)=x^2-4\)</span> for <span class="math notranslate nohighlight">\(x\in [-5, 5]\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(f(x)=sin(x)\)</span> for <span class="math notranslate nohighlight">\(x\in [0, \pi]\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(f(x)=log(x)\)</span> for <span class="math notranslate nohighlight">\(x\in [0.5, 2.5]\)</span>.</p></li>
</ol>
</li>
<li><p>Consider a second-order function, e.g.Â <span class="math notranslate nohighlight">\(f(x)=x^2-4\)</span>, which has
a minimum at <span class="math notranslate nohighlight">\(x=0\)</span>.</p>
<ol class="arabic simple">
<li><p>Plot <span class="math notranslate nohighlight">\(f()\)</span> and its derivative <span class="math notranslate nohighlight">\(f'()\)</span> using matplotlib.</p></li>
<li><p>Do you see a link between the root of <span class="math notranslate nohighlight">\(f'()\)</span> and the minimum
of <span class="math notranslate nohighlight">\(f()\)</span>?</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton()</span></code> function, which is for finding
the roots of a function, find the <em>minimum</em> of function
<span class="math notranslate nohighlight">\(f()\)</span>. Hint: A minimum is a root of the first order
derivative.</p></li>
</ol>
</li>
</ul>
</div>
</div>


        </div>
        <div class="side-doc-outline">
            <div class="side-doc-outline--content"> 
<div class="localtoc">
    <p class="caption">
      <span class="caption-text">Table Of Contents</span>
    </p>
    <ul>
<li><a class="reference internal" href="#">11. An Application: Approximation and Optimization</a><ul>
<li><a class="reference internal" href="#approximating-functions-with-taylor-series">11.1. Approximating Functions with Taylor Series</a><ul>
<li><a class="reference internal" href="#taylor-series-example-in-python">11.1.1. Taylor Series Example in Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#finding-the-roots-of-a-function">11.2. Finding the Roots of a Function</a><ul>
<li><a class="reference internal" href="#newtons-method-for-finding-the-roots">11.2.1. Newtonâs Method for Finding the Roots</a></li>
<li><a class="reference internal" href="#misc-details-on-newtons-method-for-the-curious">11.2.2. Misc Details on Newtonâs Method for the Curious</a></li>
<li><a class="reference internal" href="#newtons-method-in-python">11.2.3. Newtonâs Method in Python</a></li>
<li><a class="reference internal" href="#newtons-method-in-scipy">11.2.4. Newtonâs Method in SciPy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#finding-a-minimum-of-functions">11.3. Finding a Minimum of Functions</a><ul>
<li><a class="reference internal" href="#newtons-method-for-finding-the-minimum-of-a-function">11.3.1. Newtonâs Method for Finding the Minimum of a Function</a></li>
<li><a class="reference internal" href="#misc-details-for-the-curious">11.3.2. Misc Details for the Curious</a></li>
<li><a class="reference internal" href="#id1">11.3.3. Newtonâs Method in Python</a></li>
<li><a class="reference internal" href="#newtons-method-for-finding-minima-in-scipy">11.3.4. Newtonâs Method for Finding Minima in SciPy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#important-concepts">11.4. Important Concepts</a></li>
<li><a class="reference internal" href="#further-reading">11.5. Further Reading</a></li>
<li><a class="reference internal" href="#exercises">11.6. Exercises</a></li>
</ul>
</li>
</ul>

</div>
            </div>
        </div>

      <div class="clearer"></div>
    </div><div class="pagenation">
     <a id="button-prev" href="ch10_scientific_libraries.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="P">
         <i class="pagenation-arrow-L fas fa-arrow-left fa-lg"></i>
         <div class="pagenation-text">
            <span class="pagenation-direction">Previous</span>
            <div>10. Scientific and Engineering Libraries</div>
         </div>
     </a>
     <a id="button-next" href="ch12_regression.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="N">
         <i class="pagenation-arrow-R fas fa-arrow-right fa-lg"></i>
        <div class="pagenation-text">
            <span class="pagenation-direction">Next</span>
            <div>12. An Application: Solving a Simple Regression Problem</div>
        </div>
     </a>
  </div>
        
        </main>
    </div>
  </body>
</html>